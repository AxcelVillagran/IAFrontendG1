import 'package:process_run/shell.dart';

final shell = Shell();

Future<void> startCapture() async {
  final scriptPath = r'C:\Users\AVGla\Downloads\wireshart_data.py'; // Correctly formatted script path
  final powerShellPath = r'C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe'; // Ensure PowerShell path

  // PowerShell command to run the script as an administrator
  final command = '$powerShellPath -Command "Start-Process python -ArgumentList \\"$scriptPath\\" -Verb RunAs"';

  try {
    await shell.run(command);
    print('Script executed.');
  } catch (e) {
    print('Error executing script: $e');
  }
}
